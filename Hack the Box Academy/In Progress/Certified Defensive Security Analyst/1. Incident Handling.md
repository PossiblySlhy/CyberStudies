# Incident Handling

## Introduction
### Definitions and Scope
- `Event` > action occurring in a system or network
  - e.g. &rarr; user sending an email, a mouse click, a firewall allowing a connection request
- `Incident` > event with a negative conseqeunce
  - e.g. &rarr; data theft, funds theft, unauthorized access to data, installation and usage of malware and remote access tools
  - can occur due to natural disasters, power failures, etc.
  - no clear definition, varies by org
    - some orgs consider incidents events with clear intent to cause harm against their systems
  - may not be clear than an event is an incident
- `Incident handling` > clearly defined set of procedures to manage and respond to security incidents in a computer or network environment
  - not limited to intrusion incidents alone
  - malicious insiders, availability issues, and loss of intellectual property fall under scope
  - plans should address various types of incidents and provide appropriate mesaures to identify, contain, eradicate, and recover from them to restore normal bussiness operations quickly and efficiently

#### Important Resource
- [NIST's Computer Security Incident Handling Guide](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf)
  - aims to assist orgs in mitigating the risks from computer security incidents
  - provides practical guidelines on responding to incidents

<br/>

### Cyber Kill Chain
- attack lifecycle (a.k.a Cyber Kill Chain)
- aescribes how attacks manifest
- nonlinear, attacker might move between various stages
  - e.g. &rarr; installation back to recon to identify additional targets and find other vulnerabilities
#### 7 Stages
1. `Reconaissance`
   - attacker chooses the target and performs information gathering
   - can be active or passive
     - use social media and job listings
     - some might poke around the network by scanning webapps and IP addresses
2. `Weaponize`
   - malware is developed and embedded into some type of exploit or deliverable payload
   - likely that the attacker has gather info to identify antivirus or `EDR` (Endpoinrt Detection and Response) technology
   - aiming to get remote access to a machine in the target environment and establish persistance
3. `Deliver`
   - malware payload is delivered
     - usually through phishing emails or dummy website that mimics an official site
     - some attackers may call the victim as part of a social engineering attack
     - extreme cases involve physical delivery via USB or other physical connections
   - credentials are collected
4. `Exploit`
   - the moment an exploit or payload is triggered
   - attack attempts to execute code to gain access or control
5. `Install`
   - stager is executed and is active
   - techniques include
     - `droppers` > small piece of code designed to install malware and execute it, delivered through email attachments, malicious websites, or social engineering tactics
     - `backdoors` > malware designed to provide the attacker with persistance on the system, may be installed during the exploitation stage or or via a dropper to execute further attacks or steal data
     - `rootkits` > malware designed to hide its presence on the system, used in the installation stage to evade detection by antivirus and other security tools
6. `Command and Control (C&C)`
   -  attacker establishes remote access capability to the compromised machine
   -  some may use modular stagers to load additional scripts on-the-fly
   -  more advanced threats may use separate tools to ensure multiple variants of the malware live in the network
7. `Action`
   - the objective of the attack
   - varies based on the threat actor
     - e.g. &rarr; exfiltration of data, privilege escalation to deploy ransomware

<br/>

## Incident Handling Process
### Overview
- incident handling process defines an org's ability to prepare, detect, and respond to malicious events
- also contains stages, similar to the kill chain, but not 1-to-1
#### Stages (defined by NIST)
1. `Preparation`
2. `Detection and Analysis`
3. `Containment, Eradication, and Recovery`
4. `Post-Incident Activity`
- most of the time is spent in `preparation` and `detection analysis`
  - resources should always be active on these two
